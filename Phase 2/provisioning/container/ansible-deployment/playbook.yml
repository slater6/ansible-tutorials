  - name: Deploy hello-world
    hosts: localhost
    gather_facts: false
    tasks:
      - docker_service:
            definition:
                services: &id001
                    web:
                        image: hello-world-web:20180327060234
                        command:
                          - nginx
                          - -g
                          - daemon off;
                        ports:
                          - 80:80
                    app:
                        image: hello-world-app:20180327060507
                        command:
                          - node
                        ports:
                          - 3000:3000
                        volumes:
                          - /vagrant/app:/var/www/html
                version: '2'
            state: present
            project_name: hello-world
        tags:
          - start
      - docker_service:
            definition:
                services: *id001
                version: '2'
            state: present
            project_name: hello-world
            restarted: true
        tags:
          - restart
      - docker_service:
            definition:
                services: *id001
                version: '2'
            state: present
            project_name: hello-world
            stopped: true
        tags:
          - stop
      - docker_service:
            definition:
                services: *id001
                version: '2'
            state: absent
            project_name: hello-world
            remove_volumes: yes
        tags:
          - destroy
      - docker_image:
            state: absent
            force: yes
            name: hello-world-web:20180327060234
        tags: destroy
      - docker_image:
            state: absent
            force: yes
            name: hello-world-web:latest
        tags: destroy
      - docker_image:
            state: absent
            force: yes
            name: hello-world-app:20180327060507
        tags: destroy
      - docker_image:
            state: absent
            force: yes
            name: hello-world-app:latest
        tags: destroy
      - docker_image:
            state: absent
            force: yes
            name: hello-world-conductor:latest
        tags: destroy
